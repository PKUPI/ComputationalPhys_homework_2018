## this a revised versionof, based on Yifan Li's code, thanks him
